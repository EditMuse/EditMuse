(function(){'use strict';function getSessionId(){var p=new URLSearchParams(window.location.search);return p.get('sid');}function showLoading(){var c=document.querySelector('[data-editmuse-results]');if(!c)return;c.querySelector('.editmuse-results-loading').style.display='flex';c.querySelector('.editmuse-results-content').style.display='none';c.querySelector('.editmuse-results-error').style.display='none';}function showError(){var c=document.querySelector('[data-editmuse-results]');if(!c)return;c.querySelector('.editmuse-results-loading').style.display='none';c.querySelector('.editmuse-results-content').style.display='none';c.querySelector('.editmuse-results-error').style.display='flex';}function showContent(){var c=document.querySelector('[data-editmuse-results]');if(!c)return;c.querySelector('.editmuse-results-loading').style.display='none';c.querySelector('.editmuse-results-content').style.display='block';c.querySelector('.editmuse-results-error').style.display='none';}function renderProducts(handles){var grid=document.querySelector('.editmuse-results-grid');if(!grid)return;grid.innerHTML='';if(!handles||handles.length===0){grid.innerHTML='<p>No recommendations available yet.</p>';return;}handles.forEach(function(handle){var card=document.createElement('a');card.href='/products/'+handle;card.className='editmuse-results-card';card.innerHTML='<div class="editmuse-results-card-image-wrapper"><img src="" alt="Product" class="editmuse-results-card-image" loading="lazy"/></div><div class="editmuse-results-card-info"><h3 class="editmuse-results-card-title">Loading...</h3><div class="editmuse-results-card-price"></div><span class="editmuse-results-card-link">View product</span></div>';grid.appendChild(card);fetch('/products/'+handle+'.json').then(function(r){return r.json();}).then(function(p){var img=card.querySelector('img');var title=card.querySelector('.editmuse-results-card-title');var price=card.querySelector('.editmuse-results-card-price');if(p.product){if(p.product.featured_image)img.src=p.product.featured_image;title.textContent=p.product.title;if(p.product.variants&&p.product.variants[0])price.textContent='$'+parseFloat(p.product.variants[0].price).toFixed(2);}}).catch(function(e){console.error('Error loading product:',e);});});}function loadResults(){showLoading();var sid=getSessionId();if(!sid){showError();return;}var url='/apps/editmuse/session/'+encodeURIComponent(sid)+'/recommendations';fetch(url).then(function(r){return r.json();}).then(function(data){if(data.productHandles&&data.productHandles.length>0){renderProducts(data.productHandles);showContent();}else{var grid=document.querySelector('.editmuse-results-grid');if(grid)grid.innerHTML='<p>No recommendations available yet. Please check back soon.</p>';showContent();}}).catch(function(e){console.error('Error:',e);showError();});}if(document.readyState==='loading'){document.addEventListener('DOMContentLoaded',loadResults);}else{loadResults();}})();
